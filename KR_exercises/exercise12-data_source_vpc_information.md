# 데이터 소스를 사용하여 VPC 정보 가져오기

## Introduction

이 연습에서는 AWS 콘솔에서 수동으로 생성한 가상 프라이빗 클라우드(VPC)에서 정보를 가져오는 방법을 배웁니다. 이 작업은 `aws_vpc` 데이터 소스 블록을 사용하고 필터 기준을 지정하여 수행됩니다. 이 과정을 통해 AWS 인프라의 기존 리소스에 대한 데이터를 검색하고 활용하는 방법을 실습을 통해 이해할 수 있습니다.

## Desired Outcome

자세한 단계별 내용과 솔루션 동영상을 살펴보기 전에 한 번 사용해 보고 싶은 경우, 생성된 솔루션이 배포해야 하는 내용을 간략하게 살펴보세요:

1. 다음 구성을 사용하여 AWS 콘솔에서 가상 프라이빗 클라우드(VPC)를 수동으로 생성합니다:
    - Name: console-managed
    - Environment (`Env`) tag: Prod
    - CIDR Block: 10.0.0.0/16
2. 올바른 필터 기준을 지정하는 `aws_vpc` 데이터 소스 블록을 통해 `Env` 태그를 기반으로 VPC 정보를 가져옵니다.
3. 검색된 VPC의 `id`를 표시할 출력을 정의합니다.

## Step-by-Step Guide

### 콘솔에서 VPC 만들기

프로젝트 외부에서 관리되는 VPC에서 정보를 가져올 수 있도록 AWS 콘솔에서 수동으로 VPC를 생성해 보겠습니다:

1. AWS 관리 콘솔에 로그인하고 VPC 대시보드로 이동합니다.
2. 왼쪽 메뉴에서 "내 VPC" 링크를 클릭합니다.
3. "VPC 생성" 버튼을 클릭합니다.
4. AWS에서 VPC만 생성할지 아니면 관련 리소스도 생성할지 묻는 메시지가 표시되면 "VPC만" 옵션을 선택합니다.
5. `console-managed` 값으로 `Name` 태그를 추가합니다.
6. `Prod` 값과 함께 `Env` 태그를 추가합니다.
7. `10.0.0.0/16`을 CIDR 블록으로 설정합니다.
8. 나머지 설정은 기본값으로 둡니다.
9. "생성" 버튼을 클릭합니다.
10. 이제 새 VPC가 VPC 목록에 표시됩니다.

### 데이터 소스를 사용하여 VPC 정보 가져오기

VPC가 생성되었으므로 이제 Terraform의 데이터 소스를 사용하여 해당 정보를 가져올 수 있습니다. Terraform의 데이터 소스는 인프라의 기존 리소스에 대한 읽기 전용 액세스 권한으로, 테라폼 외부에서 관리되거나 테라폼 코드에서 참조용으로만 필요할 수 있습니다.

1. `aw_vpc` 데이터 소스 블록을 정의하고 이전 섹션에서 설정한 `Env` 태그를 사용하도록 필터 기준을 지정합니다.

    ```
    data "aws_vpc" "prod_vpc" {
      tags = {
        Env = "Prod"
      }
    }
    ```

2. 검색된 VPC의 `id`를 표시하는 출력 값을 정의합니다.

    ```
    output "prod_vpc_id" {
      value = data.aws_vpc.prod_vpc.id
    }
    ```

3. `Env` 태그에 존재하지 않는 값을 입력해 보세요. `terraform plan`을 실행하면 어떻게 되나요?

## Congratulations on Completing the Exercise!

이 연습을 완료해 주셔서 감사합니다! AWS 콘솔에서 수동으로 생성한 가상 프라이빗 클라우드(VPC)에서 정보를 가져오는 방법을 배웠습니다. 계속 열심히 하세요!
